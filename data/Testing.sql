use [GD2C2020]
go


/* compra */



SELECT DISTINCT *
FROM NO_HAY_BACKUP.AUTO 
JOIN NO_HAY_BACKUP.TIPO_AUTO A
ON AUTO_TIPO_COD = TIPO_AUTO_CODIGO
LEFT JOIN NO_HAY_BACKUP.TIPO_X_MODELO X
ON A.TIPO_AUTO_CODIGO = X.TIPO_AUTO_CODIGO
JOIN NO_HAY_BACKUP.AUTO_MODELO M
ON X.MODELO_CODIGO = M.MODELO_CODIGO


/* Duracion: */
SELECT DISTINCT  AUTO_CODIGO, AUTO_TIPO_COD, C.MODELO_CODIGO
FROM NO_HAY_BACKUP.TIPO_X_MODELO A
JOIN NO_HAY_BACKUP.AUTO_MODELO C
ON A.MODELO_CODIGO = C.MODELO_CODIGO
JOIN NO_HAY_BACKUP.AUTO
ON AUTO_TIPO_COD = A.TIPO_AUTO_CODIGO
ORDER BY AUTO_CODIGO, AUTO_TIPO_COD, C.MODELO_CODIGO





SELECT DISTINCT TIPO_AUTO_CODIGO FROM gd_esquema.Maestra
WHERE TIPO_AUTO_CODIGO IS NOT NULL
ORDER BY TIPO_AUTO_CODIGO 

SELECT DISTINCT MODELO_CODIGO FROM gd_esquema.Maestra
WHERE TIPO_AUTO_CODIGO IS NOT NULL
ORDER BY MODELO_CODIGO 

SELECT DISTINCT AUTO_NRO_MOTOR, MODELO_CODIGO, TIPO_AUTO_CODIGO, AUTO_CANT_KMS, AUTO_FECHA_ALTA, COMPRA_NRO FROM gd_esquema.Maestra
WHERE TIPO_AUTO_CODIGO IS NOT NULL
ORDER BY AUTO_NRO_MOTOR, MODELO_CODIGO, TIPO_AUTO_CODIGO 


SELECT * FROM NO_HAY_BACKUP.AUTO_PARTE 
JOIN NO_HAY_BACKUP.AUTO_PARTE_X_FABRICANTE A
ON AUTO_PARTE_CODIGO = AUTO_PARTE_FABRICANTE_COD
JOIN NO_HAY_BACKUP.FABRICANTE F
ON F.FABRICANTE_CODIGO = A.FABRICANTE_CODIGO
JOIN NO_HAY_BACKUP.FACTURA
ON AUTO_PARTE_CODIGO = FACT_PRODUCTO_COD
WHERE TIPO_PRODUCTO = 'Autoparte'

SELECT * 
FROM NO_HAY_BACKUP.AUTO A
JOIN NO_HAY_BACKUP.TIPO_X_MODELO B
ON A.AUTO_TIPO_COD = B.TIPO_AUTO_CODIGO
JOIN NO_HAY_BACKUP.AUTO_MODELO C
ON C.MODELO_CODIGO = B.MODELO_CODIGO
JOIN NO_HAY_BACKUP.COMPRA
ON AUTO_CODIGO = COMPRA_PRODUCTO_COD
ORDER BY COMPRA_NRO


/* 71946 ROWS*/
SELECT DISTINCT * FROM NO_HAY_BACKUP.AUTO
ORDER BY AUTO_NRO_MOTOR

/* 71946 rows*/
SELECT * FROM NO_HAY_BACKUP.COMPRA
WHERE COMPRA_PRODUCTO_TIPO = 'Auto'
order by COMPRA_PRODUCTO_COD

/* 1008 ROWS*/
select * from no_hay_backup.auto_modelo


select DISTINCT COMPRA_PRODUCTO_TIPO, 'Compra', COMPRA_NRO, COMPRA_PRECIO, COMPRA_CANT, SUCURSAL_CIUDAD_COD, SUCURSAL_CODIGO, CODIGO_CLIENTE, 
M.MODELO_TIPO_MOTOR_CODIGO, M.MODELO_CAJA_COD, M.MODELO_TRANSMISION_COD, A.TIPO_AUTO_CODIGO, null, --NO_HAY_BACKUP.fx_codigo_potencia(M.MODELO_POTENCIA),
M.MODELO_CODIGO, null, null, null --NO_HAY_BACKUP.fx_codigo_tiempo(COMPRA_FECHA)
FROM NO_HAY_BACKUP.COMPRA
JOIN NO_HAY_BACKUP.SUCURSAL 
ON COMPRA_SUCURSAL_COD = SUCURSAL_CODIGO
JOIN NO_HAY_BACKUP.CLIENTE
ON COMPRA_CLIENTE_COD = CODIGO_CLIENTE
JOIN NO_HAY_BACKUP.AUTO
ON COMPRA_PRODUCTO_COD = AUTO_CODIGO
JOIN NO_HAY_BACKUP.TIPO_AUTO A
ON AUTO_TIPO_COD = AUTO_TIPO_COD
JOIN NO_HAY_BACKUP.TIPO_X_MODELO X
ON A.TIPO_AUTO_CODIGO = X.TIPO_AUTO_CODIGO
JOIN NO_HAY_BACKUP.AUTO_MODELO M
ON X.MODELO_CODIGO = M.MODELO_CODIGO
WHERE COMPRA_PRODUCTO_TIPO = 'Auto'

